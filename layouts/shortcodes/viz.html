<script type="text/javascript">
	viz = function() {
		{{ $vizmode := "vega-lite" }}
		{{ if .Get "mode" }}
			{{ $vizmode := .Get "mode" }}
		{{ else }}
			{{ $vizmode := "vega-lite" }}
		{{ end }}
		{{ $url := (printf "%s%s%s" "data/" (.Get "data") ".json")}}
		{{ $dataJ := getJSON $url }}
		vizSpec = {{$dataJ}};
		opt = { mode: {{$vizmode}}, actions: false };
		{{ if .Get "width" }}
			opt['width'] = {{ .Get "width" }};
		{{ end }}
		vegaEmbed('{{.Get "id"}}', vizSpec, opt, function(error, result) {
				return;
		});
	}
	if(window.addEventListener){
		window.addEventListener('load', viz);
	}else{
		window.attachEvent('onload', viz);
	}
</script>
